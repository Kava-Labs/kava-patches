From 073fc300709d2f6b02595fe7385a6fa0a3636442 Mon Sep 17 00:00:00 2001
From: Nick DeLuca <nickdeluca08@gmail.com>
Date: Mon, 24 Oct 2022 23:56:16 +0000
Subject: [PATCH 10/12] Fix Account Type() method for comparing EOA accounts
 with empty code hash (0x prefixed)

---
 types/account.go      | 2 +-
 types/account_test.go | 4 ++--
 2 files changed, 3 insertions(+), 3 deletions(-)

diff --git a/types/account.go b/types/account.go
index d34ccdb3..9586f279 100644
--- a/types/account.go
+++ b/types/account.go
@@ -70,7 +70,7 @@ func (acc *EthAccount) SetCodeHash(codeHash common.Hash) error {
 
 // Type returns the type of Ethereum Account (EOA or Contract)
 func (acc EthAccount) Type() int8 {
-	if bytes.Equal(emptyCodeHash, common.Hex2Bytes(acc.CodeHash)) {
+	if bytes.Equal(emptyCodeHash, common.HexToHash(acc.CodeHash).Bytes()) {
 		return AccountTypeEOA
 	}
 	return AccountTypeContract
diff --git a/types/account_test.go b/types/account_test.go
index 10b18a60..7571e9bd 100644
--- a/types/account_test.go
+++ b/types/account_test.go
@@ -51,8 +51,8 @@ func TestAccountTestSuite(t *testing.T) {
 }
 
 func (suite *AccountTestSuite) TestAccountType() {
-	suite.account.CodeHash = common.Bytes2Hex(crypto.Keccak256(nil))
+	suite.account.CodeHash = common.BytesToHash(crypto.Keccak256(nil)).Hex()
 	suite.Require().Equal(types.AccountTypeEOA, suite.account.Type())
-	suite.account.CodeHash = common.Bytes2Hex(crypto.Keccak256([]byte{1, 2, 3}))
+	suite.account.CodeHash = common.BytesToHash(crypto.Keccak256([]byte{1, 2, 3})).Hex()
 	suite.Require().Equal(types.AccountTypeContract, suite.account.Type())
 }
-- 
2.38.1

